# Hacking

Вот несколько советов, которые помогут вам создать и протестировать этот проект в качестве разработчика и потенциального участника.

## Режим разработчика

Цели системы сборки, которые полезны только для разработчиков этого проекта, скрыты, если опция `CircuitGen_Generator_DEVELOPER_MODE` отключена. Включение этой опции делает доступными тесты и другие цели и параметры разработчика. Если вы не включите эту опцию, вы являетесь потребителем этого проекта и, следовательно, вам не нужны эти цели и параметры.

Режим разработчика всегда включен в рабочих процессах CI.

### Правила именования переменных

Правила именования переменных:
- d_anything означает поле класса;
- i_anything принимаемый аргумент в функцию.

### Пресеты

В этом проекте используются [пресеты][1] для упрощения процесса настройки проекта. Как разработчику вам рекомендуется всегда устанавливать [последнюю версию CMake][2], чтобы использовать последние дополнения качества жизни.

У вас есть несколько вариантов передачи `CircuitGen_Generator_DEVELOPER_MODE` в команду настройки, но в этом проекте предпочитают использовать пресеты.

Как разработчик, вы должны создать файл `CMakeUserPresets.json` в корне проекта:

```json
{
  "version": 2,
  "cmakeMinimumRequired": {
    "major": 3,
    "minor": 14,
    "patch": 0
  },
  "configurePresets": [
    {
      "name": "dev",
      "binaryDir": "${sourceDir}/build/dev",
      "inherits": ["dev-mode", "ci-linux"],
      "cacheVariables": {
        "CMAKE_BUILD_TYPE": "Debug"
      }
    }
  ],
  "buildPresets": [
    {
      "name": "dev",
      "configurePreset": "dev",
      "configuration": "Debug"
    }
  ],
  "testPresets": [
    {
      "name": "dev",
      "configurePreset": "dev",
      "configuration": "Debug",
      "output": {
        "outputOnFailure": true
      }
    }
  ]
}
```

Вам следует заменить `<os>` в новом файле настроек на имя вашей операционной системы, которая может быть `win64`, `linux` или `darwin`. Вы можете увидеть, чему они соответствуют, в файле [`CMakePresets.json`](CMakePresets.json).

`CMakeUserPresets.json` также является идеальным местом, куда вы можете поместить все, что в противном случае вы хотели бы передать команде configure в терминале.

> **Примечание**
> Некоторые редакторы довольно жадны в открытии проектов с пресетами.
> Некоторые просто случайно выбирают пресет и начинают настраивать без вашего согласия,
> что может сбить с толку. Убедитесь, что Ваш редактор настраивается, когда Вам
> на самом деле этого хочется, например, в CLion Вам нужно убедиться, что только
> в `dev-dev preset` установлен флажок `Включить профиль`
> `Файл > Настройки... > Сборка, выполнение, развертывание > CMake` и в Visual Studio
> Вам необходимо установить опцию «Никогда не запускать шаг настройки автоматически»
> в `Инструменты > Параметры > CMake` **до открытия проекта**, после чего
> Вы можете настроить вручную, используя «Проект > Настроить кэш».

### Настройка, сборка и тестирование

Если Вы следовали приведенным выше инструкциям, то Вы можете настроить, собрать и протестировать проект соответственно с помощью следующих команд из корня проекта в любой операционной системе с любой системой сборки:

```sh
cmake --preset=dev
cmake --build --preset=dev
ctest --preset=dev
```

Если вы используете совместимый редактор (например, VSCode) или IDE (например, CLion, VS), вы также сможете выбрать созданные выше пользовательские пресеты для автоматической интеграции.

Обратите внимание, что и команды сборки, и команды тестирования принимают флаг `-j` для указания количества используемых заданий, которое в идеале должно быть указано в соответствии с количеством потоков вашего процессора. Вы также можете добавить это в свой пресет, используя свойство `jobs`, более подробную информацию можно найти в [документации по пресетам][1].

### Цели режима разработчика

Это цели, которые вы можете вызвать с помощью приведенной выше команды сборки с дополнительным флагом `-t <target>`:

#### `coverage`

Доступно, если включен `ENABLE_COVERAGE`. Эта цель обрабатывает выходные данные ранее запущенных тестов при построении с конфигурацией покрытия. Команды, которые выполняет эта цель, можно найти в переменных кэша `COVERAGE_TRACE_COMMAND` и `COVERAGE_HTML_COMMAND`. Команда трассировки по умолчанию создает информационный файл, который можно отправить в службы с интеграцией CI. Команда HTML использует выходные данные команды трассировки для создания HTML-документа в `<binary-dir>/coverage_html` по умолчанию.

#### `docs`

Доступно, если включен `BUILD_MCSS_DOCS`. Сборка документации с использованием Doxygen и m.css. По умолчанию вывод будет идти в `<binary-dir>/docs` (настраивается с помощью `DOXYGEN_OUTPUT_DIRECTORY`).

#### `format-check` и `format-fix`

Эти цели запускают инструмент формата clang в базе кода для проверки ошибок и их исправления соответственно. Доступна настройка с использованием переменных кэша `FORMAT_PATTERNS` и `FORMAT_COMMAND`.

#### `run-exe`

Запускает исполняемый целевой файл `CircuitGen_Generator_exe`.

#### `spell-check` и `spell-fix`

Эти цели запускают инструмент кодирования в базе кода для проверки ошибок и их исправления соответственно. Доступна настройка с использованием переменной кэша `SPELL_COMMAND`.

[1]: https://cmake.org/cmake/help/latest/manual/cmake-presets.7.html
[2]: https://cmake.org/download/

### Правила документирования кода

- 1: Все описания и комментирование кода/добавление TO DO пишутся в файлах с расширение .hpp
- 2: Всё содержимое должно заключаться в ///
```hpp
#include <iostream>

///
///
///
```
- 3: TO DO пишутся после подключения библиотек. Перед @file упоминается автор при необходимости
```hpp
#include <iostream>

/// @author <Имя автора>
/// @file <название файла.hpp>
/// TO DO: <описание>

```
- 4: Для описание методов/функций указывается тег @brief
```hpp
#include <iostream>

/// @file <название файла.hpp>
/// TO DO: <описание>

/// @brief sum
/// <Описание функции>

int sum (int a, int b);

int main()
{
    
}

```
- 5: Для описание классов, пространств имён указывается тег class, namespace
```hpp
/// namespace AuxMethods
/// <описание пространства имён>

namespace AuxMethods
{
    ...
}


/// class Graph
/// <описание класса>

class Graph
{
    ...
}
```
- 6: Описание параметров классов, параметров функций/методов - тег @param <название переменной> <описание переменной>
**Пример полного описания класса**
```hpp

/// class Graph
/// <описание класса>
/// @param v
/// <описание параметра>
/// @param adj
/// <описание параметра>

class Graph
{
private:
    int V;
    vector<vector<int>> adj;

public:
    Graph(int vertices)
    {
        V = vertices;
        adj.resize(V);
    }
    
    /// @brief addEdge
    /// <описание метода>
    /// @param v <описание параметра>
    /// @param w <описание параметра>
    
    void addEdge(int v, int w);

};
```
- 7: Возвращаемое значение, тег - @return
```hpp
/// @brief getAdjacencyList
/// <описание метода>
/// @param v
/// <описание параметра>
/// @return <описание возвращаемого значения>
    vector<int> getAdjacencyList(int v) const
    {
        return adj[v];
    }
```
- 8: Описание исключения, тег - @throw
```hpp
#include <iostream>
#include <stdexcept>

/// @brief Делит два числа.
/// Функция divide выполняет деление двух чисел и возвращает результат.
/// Если делитель равен нулю, функция бросает исключение runtime_error.

/// @param dividend Делимое число.
/// @param divisor Делитель.
/// @return double Результат деления.
///
/// @throw runtime_error Если делитель равен нулю.

double divide(double dividend, double divisor)
{
    if (divisor == 0) {
        throw runtime_error("Деление на ноль недопустимо!");
    }
    return dividend / divisor;
}
```
- 9: Добавление кода в документацию, код заключен в @code и @endcode соответственно
**Пример полного описание функции**
```
#include <iostream>
#include <stdexcept>

/// @brief Делит два числа.
/// 
/// Функция divide выполняет деление двух чисел и возвращает результат.
/// Если делитель равен нулю, функция бросает исключение runtime_error.

/// @param dividend Делимое число.
/// @param divisor Делитель.
/// @return double Результат деления.
/// @code
/// double a = 10.0;
/// double b = 2.0;
/// double result = divide(a, b); // result будет равен 5.0
/// @endcode
/// @throw runtime_error Если делитель равен нулю.

double divide(double dividend, double divisor)
{
    if (divisor == 0) {
        throw runtime_error("Деление на ноль недопустимо!");
    }
    return dividend / divisor;
}
```
- 10: При необходимости в описании какого-либо объекта нужно ссылаться на
другой, например на метод другого класса - используется тег @see <название объекта>
- 11: При описании перечеслений необходимо использовать @brief и перед каждым полем дать характеристику
**Пример описания enum**
```
/// @brief VertexTypes
/// Enumeration of vertex types

enum VertexTypes { ///  input vertex
  input,           ///  output vertex
  output,          /// constant vertex
  constant,        /// vertex representing a logical element
  gate,            /// subgraph that makes up the vertex
  subGraph   
};
```